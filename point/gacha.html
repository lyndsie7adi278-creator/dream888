<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <title>豪華物理扭蛋機</title>
    <style>
        :root {
            --machine-color: #ff4757;
            --glass-bg: rgba(255, 255, 255, 0.2);
        }

        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background: #2f3542;
            margin: 0;
            font-family: Arial, sans-serif;
        }

        /* 扭蛋機主體 */
        .gacha-container {
            position: relative;
            width: 320px;
            height: 500px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* 透明圓頂艙 */
        .glass-dome {
            width: 280px;
            height: 280px;
            background: var(--glass-bg);
            border: 4px solid #fff;
            border-radius: 50%;
            position: relative;
            overflow: hidden;
            box-shadow: inset 0 0 50px rgba(255,255,255,0.5);
            z-index: 2;
        }

        /* 球的設計 */
        .ball {
            position: absolute;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            box-shadow: inset -5px -5px 10px rgba(0,0,0,0.2);
        }

        /* 滾動動畫：隨機碰撞感 */
        @keyframes ball-roll {
            0% { transform: translate(0, 0) rotate(0deg); }
            20% { transform: translate(80px, -100px) rotate(180deg); }
            40% { transform: translate(-80px, -150px) rotate(360deg); }
            60% { transform: translate(60px, -80px) rotate(540deg); }
            80% { transform: translate(-40px, -120px) rotate(720deg); }
            100% { transform: translate(0, 0) rotate(900deg); }
        }

        .rolling {
            animation: ball-roll 0.8s ease-in-out infinite;
        }

        /* 機器下半部 */
        .machine-body {
            width: 260px;
            height: 200px;
            background: var(--machine-color);
            border-radius: 20px 20px 50px 50px;
            margin-top: -50px;
            position: relative;
            z-index: 1;
            border: 5px solid #d63031;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        /* 旋鈕 */
        .crank {
            width: 80px;
            height: 80px;
            background: #f1f2f6;
            border: 5px solid #747d8c;
            border-radius: 50%;
            margin-top: 30px;
            cursor: pointer;
            transition: transform 0.5s;
            display: flex;
            justify-content: center;
            align-items: center;
            font-weight: bold;
            color: #2f3542;
        }

        .crank:active {
            transform: rotate(360deg);
        }

        /* 出蛋口 */
        .exit {
            width: 80px;
            height: 60px;
            background: #2f3542;
            border-radius: 10px;
            position: absolute;
            bottom: 20px;
            overflow: visible;
        }

        /* 掉出來的球 */
        #result-ball {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            position: absolute;
            top: -50px;
            left: 17.5px;
            display: none;
            z-index: 10;
        }

        @keyframes drop-out {
            0% { transform: translateY(0) scale(0.5); opacity: 0; }
            50% { transform: translateY(60px) scale(1.2); opacity: 1; }
            100% { transform: translateY(120px) scale(1); opacity: 1; box-shadow: 0 10px 20px rgba(0,0,0,0.5); }
        }

        .dropping {
            display: block !important;
            animation: drop-out 0.6s forwards;
        }

        /* 控制面板 */
        .ui {
            margin-top: 20px;
            color: white;
            text-align: center;
        }
    </style>
</head>
<body>

<div class="gacha-container">
    <div class="glass-dome" id="dome">
        <div class="ball" style="background: #ffbe76; left: 30%; bottom: 10px;"></div>
        <div class="ball" style="background: #ff7979; left: 50%; bottom: 15px;"></div>
        <div class="ball" style="background: #badc58; left: 70%; bottom: 10px;"></div>
        <div class="ball" style="background: #7ed6df; left: 40%; bottom: 30px;"></div>
        <div class="ball" style="background: #e056fd; left: 60%; bottom: 25px;"></div>
    </div>

    <div class="machine-body">
        <div class="crank" id="spin-btn">扭一下</div>
        
        <div class="exit">
            <div id="result-ball"></div>
        </div>
    </div>

    <div class="ui">
        <h2 id="status">準備好挑戰了嗎？</h2>
    </div>
</div>

<script>
    const spinBtn = document.getElementById('spin-btn');
    const domeBalls = document.querySelectorAll('.ball');
    const resultBall = document.getElementById('result-ball');
    const statusText = document.getElementById('status');

    const colors = ['#ff4757', '#2e86de', '#ffa502', '#2ed573', '#e84393'];

    spinBtn.addEventListener('click', () => {
        if (spinBtn.style.pointerEvents === 'none') return;

        // 1. 禁用按鈕
        spinBtn.style.pointerEvents = 'none';
        statusText.innerText = '轉動中...';
        resultBall.classList.remove('dropping');
        
        // 2. 圓頂內的球開始物理滾動動畫
        domeBalls.forEach(ball => {
            ball.classList.add('rolling');
            // 隨機化每顆球的動畫時間，增加真實感
            ball.style.animationDuration = (Math.random() * 0.4 + 0.4) + 's';
        });

        // 3. 模擬扭蛋時間
        setTimeout(() => {
            // 停止滾動
            domeBalls.forEach(ball => ball.classList.remove('rolling'));

            // 4. 產生中獎球掉落
            const randomColor = colors[Math.floor(Math.random() * colors.length)];
            resultBall.style.background = randomColor;
            resultBall.classList.add('dropping');
            
            statusText.innerText = '恭喜獲得扭蛋！';

            // 5. 恢復按鈕
            setTimeout(() => {
                spinBtn.style.pointerEvents = 'auto';
            }, 1000);

        }, 2000); // 扭蛋轉動時間 2 秒
    });
</script>

</body>
</html>
