<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>彩球挖挖樂 Pro - Dream888</title>
    <style>
        :root {
            --machine-red: #d63031;
            --deep-red: #8b0000;
            --metal-silver: linear-gradient(145deg, #bdc3c7, #2c3e50);
            --glass-shine: linear-gradient(135deg, rgba(255,255,255,0.5) 0%, rgba(255,255,255,0) 50%);
        }

        body {
            margin: 0;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background: #1a1a1a;
            font-family: 'Arial', sans-serif;
        }

        /* 扭蛋機主架構 */
        .gacha-system {
            position: relative;
            width: 350px;
            text-align: center;
        }

        /* 透明圓形艙 */
        .glass-container {
            width: 300px;
            height: 300px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            border: 8px solid #eee;
            margin: 0 auto;
            position: relative;
            overflow: hidden; /* 確保球不會飛出去 */
            backdrop-filter: blur(2px);
            box-shadow: inset 0 0 50px rgba(0,0,0,0.5), 0 10px 30px rgba(0,0,0,0.5);
            z-index: 5;
        }

        /* 模擬艙底部的漏斗斜坡 */
        .glass-container::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 60px;
            background: linear-gradient(transparent, rgba(255,255,255,0.1));
            border-top: 2px solid rgba(255,255,255,0.2);
        }

        /* 球體基本樣式 */
        .ball {
            position: absolute;
            width: 42px;
            height: 42px;
            border-radius: 50%;
            box-shadow: inset -4px -4px 8px rgba(0,0,0,0.4), 2px 4px 6px rgba(0,0,0,0.3);
            transition: all 0.3s ease;
        }

        /* 攪拌動畫：從底部向上彈跳並左右碰撞 */
        @keyframes stir-up {
            0% { transform: translate(0, 0); }
            25% { transform: translate(60px, -150px) rotate(90deg); }
            50% { transform: translate(-60px, -200px) rotate(180deg); }
            75% { transform: translate(30px, -80px) rotate(270deg); }
            100% { transform: translate(0, 0) rotate(360deg); }
        }

        .stirring {
            animation: stir-up 0.6s cubic-bezier(0.4, 0, 0.2, 1) infinite !important;
        }

        /* 機器下半部 */
        .base-unit {
            width: 320px;
            height: 250px;
            background: var(--machine-red);
            margin: -80px auto 0;
            border-radius: 20px 20px 40px 40px;
            border: 6px solid #fff;
            position: relative;
            z-index: 1;
            box-shadow: inset 0 10px 20px rgba(0,0,0,0.3);
        }

        /* 旋鈕 */
        .crank-zone {
            margin-top: 90px;
            display: inline-block;
        }

        .crank-circle {
            width: 80px;
            height: 80px;
            background: #ecf0f1;
            border: 5px solid #bdc3c7;
            border-radius: 50%;
            cursor: pointer;
            position: relative;
            transition: transform 0.8s ease-in-out;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .crank-bar {
            width: 90%;
            height: 15px;
            background: #7f8c8d;
            border-radius: 10px;
        }

        /* 出球口 */
        .exit-tunnel {
            width: 100px;
            height: 80px;
            background: #222;
            margin: 20px auto 0;
            border-radius: 10px 10px 25px 25px;
            position: relative;
            border: 4px solid #444;
            overflow: visible;
        }

        /* 中獎球掉落軌跡 */
        #prize-ball {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            position: absolute;
            top: -60px;
            left: 21px;
            display: none;
            z-index: 10;
        }

        @keyframes rolling-out {
            0% { transform: translateY(0) scale(0.6); opacity: 0; }
            30% { transform: translateY(50px) scale(1); opacity: 1; }
            60% { transform: translateY(100px) rotate(20deg); }
            100% { transform: translateY(130px) rotate(0); opacity: 1; filter: drop-shadow(0 10px 10px rgba(0,0,0,0.5)); }
        }

        .show-prize {
            display: block !important;
            animation: rolling-out 0.8s forwards ease-out;
        }

        .machine-label {
            color: white;
            font-size: 20px;
            font-weight: bold;
            text-shadow: 2px 2px 5px rgba(0,0,0,0.5);
            margin-bottom: 10px;
        }
    </style>
</head>
<body>

<div class="gacha-system">
    <div class="machine-label">彩球挖挖樂</div>

    <div class="glass-container" id="dome">
        <div class="ball" style="background: #e74c3c; left: 15%; bottom: 10px;"></div>
        <div class="ball" style="background: #3498db; left: 30%; bottom: 15px;"></div>
        <div class="ball" style="background: #f1c40f; left: 45%; bottom: 8px;"></div>
        <div class="ball" style="background: #2ecc71; left: 60%; bottom: 12px;"></div>
        <div class="ball" style="background: #9b59b6; left: 75%; bottom: 10px;"></div>
        <div class="ball" style="background: #e67e22; left: 25%; bottom: 45px;"></div>
        <div class="ball" style="background: #ecf0f1; left: 55%; bottom: 40px;"></div>
    </div>

    <div class="base-unit">
        <div class="crank-zone">
            <div class="crank-circle" id="crank-trigger">
                <div class="crank-bar"></div>
            </div>
        </div>

        <div class="exit-tunnel">
            <div id="prize-ball"></div>
        </div>
    </div>
</div>

<script>
    const crank = document.getElementById('crank-trigger');
    const domeBalls = document.querySelectorAll('.ball');
    const prizeBall = document.getElementById('prize-ball');
    const colors = ['#e74c3c', '#3498db', '#f1c40f', '#2ecc71', '#9b59b6', '#e67e22'];

    let active = false;

    crank.onclick = function() {
        if (active) return;
        active = true;

        // 1. 旋鈕轉動動畫
        crank.style.transform = "rotate(720deg)";
        prizeBall.classList.remove('show-prize');

        // 2. 艙內的球開始攪拌 (Stirring)
        domeBalls.forEach((ball, index) => {
            // 延遲一點點時間讓球一顆顆跳起來，更自然
            setTimeout(() => {
                ball.classList.add('stirring');
                ball.style.animationDuration = (0.4 + Math.random() * 0.3) + "s";
            }, index * 50);
        });

        // 3. 模擬攪拌一段時間後出球
        setTimeout(() => {
            // 停止攪拌
            domeBalls.forEach(ball => ball.classList.remove('stirring'));
            
            // 旋鈕歸位準備下次使用
            setTimeout(() => { 
                crank.style.transition = "none";
                crank.style.transform = "rotate(0deg)";
                setTimeout(() => crank.style.transition = "transform 0.8s ease-in-out", 50);
                active = false; 
            }, 1000);

            // 4. 產生中獎球掉落
            const finalColor = colors[Math.floor(Math.random() * colors.length)];
            prizeBall.style.background = `radial-gradient(circle at 30% 30%, ${finalColor}, #000)`;
            prizeBall.classList.add('show-prize');

        }, 2000);
    };
</script>

</body>
</html>
